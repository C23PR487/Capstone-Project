git clone https://github.com/C23PR487/Capstone-Project.git

npm install @hapi/hapi
npm install nanoid@3.x.x
npm install mysql

#build image
gcloud builds submit \
  --tag gcr.io/$GOOGLE_CLOUD_PROJECT/hapi-project

#deploy hapi backend
gcloud run deploy hapi-server \
  --image gcr.io/$GOOGLE_CLOUD_PROJECT/hapi-project \
  --platform managed \
  --region asia-southeast2 \
  --memory=2Gi \
  --allow-unauthenticated \
  --max-instances=1

SERVICE_URL=$(gcloud beta run services describe hapi-server --platform managed --region asia-southeast2 --format="value(status.url)")

echo $SERVICE_URL

curl -X GET $SERVICE_URL

curl -X GET -H "Authorization: Bearer $(gcloud auth print-identity-token)" $SERVICE_URL

#connect to cloud sql
gcloud sql connect database-lapak --user=root
2Q?n#GSc1oq,>c;a

use databases;
show databases;
show tables;